<template>
    <page-header title="Lobby" subtitle="available games appear here"></page-header>

    <div class="row">
        <div class="col">
            <game-stat stat.to-view="availableGamesTotal" title="Games available"></game-stat>
        </div>
        <div class="col">
            <game-stat stat.to-view="playersGamesTotal" title="My games"></game-stat>
        </div>
        <div class="col text-right">
            <button type="button" class="btn btn-secondary" click.delegate="refreshGames()">
                Refresh
            </button>
            <a class="btn btn-primary" route-href="route.bind: 'newgame'">
                Host a new game
            </a>
        </div>
    </div>

    <hr />

    <div class="row">
        <div class="col">
            <p if.bind="availableGamesLoading">
                Loading available games...
            </p>
            <table if.bind="!availableGamesLoading" class="table table-hover table-borderless">
                <thead>
                    <tr>
                        <th>Host player</th>
                        <th>Size</th>
                        <th>Mines</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr repeat.for="availableGame of availableGames">
                        <td>${ availableGame.hostPlayerDisplayName }</td>
                        <td>${ availableGame.rows }&times;${ availableGame.columns }</td>
                        <td>${ availableGame.mines }</td>
                        <td>
                            <form submit.delegate="joinGame(availableGame.gameId)">
                                <button type="submit" class="btn btn-primary">Join</button>
                            </form>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="row">
        <div class="col">
            <p if.bind="playersGamesLoading">
                Loading your active games...
            </p>
            <table if.bind="!playersGamesLoading" class="table table-hover table-borderless">
                <thead>
                    <tr>
                        <th>Other player</th>
                        <th>Size</th>
                        <th>Mines</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr repeat.for="playersGame of playersGames">
                        <td>${ playersGame.otherPlayerDisplayName }</td>
                        <td>${ playersGame.rows }&times;${ playersGame.columns }</td>
                        <td>${ playersGame.mines }</td>
                        <td>
                            <form submit.delegate="goToGame(playersGame.gameId)">
                                <button type="submit" class="btn btn-primary">Go</button>
                            </form>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

</template>
